version: 2

jobs:
  build:
    working-directory: ~/

    steps:
      - checkout
      - run:
        name: executable-gradle
        command: chmod +x gradlew
      - restore_cache
        key: dependency-cache
      - run:
        name: build-jar
        command: ./gradlew build
      - run:
        name: create-source-jar
        command: ./gradlew sourceJar
      - run:
        name: copy-artifacts
        command: cp build/libs/*.jar $CIRCLE_ARTIFACTS
      - save_cache:
        key: dependency-cache
        paths:
          - ~/.gradle/caches/minecraft/deobfedDeps
          - .gradle/minecraft

workflows:
  version: 2
  build:
    jobs:
      - build